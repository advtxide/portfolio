---
import Container from "~/components/common/container.astro";
import city from "~/assets/city.png";
import { Image } from "astro:assets";
import Layout from "../layouts/Layout.astro";
import tameImpala from "~/assets/tame-impala.png";
import perspective from "~/assets/perspective.png";
import back2back from "~/assets/back2back.png";
import Link from "~/components/common/link.astro";
import { getImage } from "astro:assets";
import Tooltip from "~/components/common/tooltip.astro";

const images = [
  { src: back2back, alt: "back2back" },
  { src: perspective, alt: "perspective" },
  { src: tameImpala, alt: "tame-impala" },
  { src: city, alt: "city" },
];
---

<Layout
  content={{
    title: "astroxide",
    description:
      "multi-disciplinary engineer obsessed with breakshit scalability and performance",
  }}
>
  <main class="">
    <Container>
      <div
        class="flex flex-col space-y-6 lg:flex-row lg:items-start lg:justify-between lg:space-y-0"
      >
        <div class="space-y-8 lg:max-w-[45%] lg:pl-4">
          <div class="space-y-2 font-light">
            <h1 class="font-serif text-4xl italic md:text-6xl">
              advait <span class="text-xl md:text-4xl">(astroxide)</span>
            </h1>
            <p
              class="font-serif text-2xl leading-[120%] [word-spacing:0.15rem] md:text-4xl"
            >
              multi-disciplinary engineer, obsessed with scale, speed and art
            </p>
          </div>
          <div class="text-muted-foreground space-y-4 text-lg">
            <p>
              i love doing things that look good while doing it. im really
              obsessive about good design, typography and ux (in pretty much
              everything around me)
            </p>
            <p>
              shipped across 5+ startups &mdash; freelance, intern, part-time.
              currently im working on side-gigs and iterating in stealth over at
              my <Link target="_blank" href="https://celestialabs.vercel.app"
                >little imaginary lab</Link
              >.
            </p>
            <p>
              outside tech, i've always had an itch for creative stuff &mdash;
              music, design, visuals etc. i used to post anime video edits,
              tried my luck at graphics and music production too.
            </p>
            <p>
              i don't really measure myself by titles, roles or a fixed timeline
              bcs of my belief in the principles of <Tooltip
                content="owning my choices so fully that I can walk away from them freely."
              >
                <Link href="/vairagya">vairagya</Link>
              </Tooltip>
            </p>
          </div>
        </div>

        <div id="masonry" class="mt-3 lg:mt-0 lg:pt-4 lg:pr-4">
          {
            images.map(async ({ src, alt }, idx) => {
              const webpImage = await getImage({ src, format: "webp" });

              return (
                <Image
                  src={webpImage.src}
                  alt={alt}
                  width="800"
                  height="600"
                  class="cursor-zoom-in grayscale"
                  data-full={webpImage.src}
                />
              );
            })
          }
        </div>
      </div>

      <div
        id="previewModal"
        class="fixed inset-0 z-50 hidden items-center justify-center bg-black/80"
      >
        <img
          id="previewImg"
          src=""
          alt="full preview"
          class="max-h-[90%] max-w-[90%] rounded-lg shadow-lg"
        />
      </div>
    </Container>
  </main>

  <script>
    function setupModal() {
      const modal = document.getElementById("previewModal") as HTMLDivElement;
      const previewImg = document.getElementById(
        "previewImg"
      ) as HTMLImageElement;

      document
        .querySelectorAll<HTMLImageElement>("#masonry img")
        .forEach((img) => {
          img.addEventListener("click", () => {
            const fullSrc = img.dataset.full;
            if (fullSrc) {
              previewImg.src = fullSrc;
              modal.classList.remove("hidden");
              modal.classList.add("flex");
            }
          });
        });

      modal.addEventListener("click", () => {
        modal.classList.add("hidden");
        modal.classList.remove("flex");
        previewImg.src = "";
      });
    }

    setupModal();
    document.addEventListener("astro:page-load", setupModal);
  </script>
</Layout>
